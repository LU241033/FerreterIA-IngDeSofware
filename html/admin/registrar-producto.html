<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- üîß Ruta corregida: el archivo CSS est√° en la carpeta css -->
  <link rel="stylesheet" href="../../css/registrar-producto.css" />
  
  <!-- üîß Tambi√©n se mantiene el estilo com√∫n (acerca.css) -->
  <link rel="stylesheet" href="../../css/acerca.css" />
  
  <link rel="shortcut icon" href="../../Img/Logo.png" type="image/x-icon" />
  <title>Registrar Producto | FerreterIA</title>
</head>

<body>
  <!-- üîπ Encabezado -->
  <header class="barra-navegacion">
    <div class="contenedor">
      <div class="logo">FerreterIA</div>
      <ul class="enlaces">
        <li><a href="../../Index.html">Inicio</a></li>
        <li><a href="../usuario/explora.html">Explora</a></li>
        <li><a href="#">Compras</a></li>
        <li><a href="#">Perfil</a></li>
        <li><a href="panel-admin.html">Gesti√≥n Productos</a></li>
      </ul>

      <div class="botones" id="botonesAuth">
        <button class="btn-borde" onclick="location.href='../Login.html'">Iniciar sesi√≥n</button>
        <button class="btn-principal" onclick="location.href='../usuario/registro.html'">Registrarse</button>
      </div>
    </div>
  </header>

  <!-- üîπ Secci√≥n principal -->
  <section class="seccion-principal">
    <div class="contenido-principal">
      <div class="encabezado-formulario">
        <h2>Registrar Producto üß∞</h2>
        <p>Agrega un nuevo producto al inventario de forma r√°pida y sencilla.</p>
      </div>

      <div class="formulario-contenedor">
        <form id="formRegistrarProducto">
          <div id="mensaje-formulario" style="display:none; margin-bottom: 15px; padding: 12px; border-radius: 8px;"></div>
          
          <div class="grupo-formulario">
            <label for="nombre">Nombre del producto:</label>
            <input type="text" id="nombre" placeholder="Ej. Martillo de acero" required />
            <span class="icono-input">üìù</span>
          </div>

          <div class="grupo-formulario">
            <label for="categoria">Categor√≠a:</label>
            <input type="text" id="categoria" placeholder="Ej. Herramientas" required />
            <span class="icono-input">üìÇ</span>
          </div>

          <div class="grupo-formulario">
            <label for="precio">Precio:</label>
            <input type="number" id="precio" step="0.01" min="0" placeholder="Ej. 25000" required />
            <span class="icono-input">üí∞</span>
          </div>

          <div class="grupo-formulario">
            <label for="stock">Cantidad en stock:</label>
            <input type="number" id="stock" min="0" placeholder="Ej. 10" required />
            <span class="icono-input">üì¶</span>
          </div>

          <button type="submit" class="boton-formulario boton-principal">Registrar Producto</button>
          <button type="button" class="boton-formulario boton-volver" onclick="location.href='panel-admin.html'">
            ‚Üê Volver a Gesti√≥n
          </button>
        </form>
      </div>
    </div>
  </section>

  <!-- üîπ Pie de p√°gina -->
  <footer class="pie-pagina">
    <div class="contenedor-pie">
      <div>
        <h4>FerreterIA</h4>
        <p>Tu socio de confianza para soluciones seguras y eficientes.</p>
      </div>

      <div>
        <h4>Enlaces r√°pidos</h4>
        <ul>
          <li><a href="../index.html">Inicio</a></li>
          <li><a href="../usuario/explora.html">Servicios</a></li>
          <li><a href="../acerca-de-nosotros.html">Acerca de</a></li>
        </ul>
      </div>

      <div>
        <h4>Servicios</h4>
        <ul>
          <li>Gesti√≥n de productos</li>
          <li>Reportes</li>
          <li>Control de inventario</li>
        </ul>
      </div>

      <div>
        <h4>Cont√°ctanos</h4>
        <p>Email: info@ferreteria.com<br>Tel: 312-XXX-XXXX</p>
      </div>
    </div>

    <p class="copy">&copy; 2025 FerreterIA. Todos los derechos reservados.</p>
  </footer>

  <!-- Scripts -->
  <script src="../../js/utils.js"></script>
  <script src="../../js/productos.js"></script>
  <script>
    // Verificar autenticaci√≥n de admin
    document.addEventListener("DOMContentLoaded", () => {
      if (!protegerRutaAdmin()) return;
      actualizarBotonesAuth();

      const form = document.getElementById("formRegistrarProducto");
      const mensajeDiv = document.getElementById("mensaje-formulario");

      form.addEventListener("submit", (e) => {
        e.preventDefault();

        const datos = {
          nombre: document.getElementById("nombre").value.trim(),
          categoria: document.getElementById("categoria").value.trim(),
          precio: document.getElementById("precio").value,
          stock: document.getElementById("stock").value
        };

        // Validar
        const validacion = validarProducto(datos);
        if (!validacion.valido) {
          mostrarMensajeEnFormulario(validacion.errores.join(", "), "error");
          return;
        }

        try {
          const nuevoProducto = gestorProductos.crear(datos);
          mostrarMensajeEnFormulario(`‚úÖ Producto "${nuevoProducto.nombre}" registrado exitosamente (ID: #${nuevoProducto.id})`, "success");
          
          // Limpiar formulario
          form.reset();
          
          // Redirigir despu√©s de 2 segundos
          setTimeout(() => {
            window.location.href = "panel-admin.html";
          }, 2000);
        } catch (error) {
          mostrarMensajeEnFormulario(`‚ùå Error: ${error.message}`, "error");
        }
      });

      function mostrarMensajeEnFormulario(mensaje, tipo) {
        mensajeDiv.textContent = mensaje;
        mensajeDiv.style.display = "block";
        mensajeDiv.style.backgroundColor = tipo === "success" ? "#10b981" : "#ef4444";
        mensajeDiv.style.color = "white";
        mensajeDiv.style.padding = "12px";
        mensajeDiv.style.borderRadius = "8px";
        mensajeDiv.style.marginBottom = "15px";
        
        setTimeout(() => {
          mensajeDiv.style.display = "none";
        }, 5000);
      }
    });
  </script>
</body>
</html>
